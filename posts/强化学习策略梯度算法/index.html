<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="ç¥å¥‡çš„æˆ˜å£«"><link rel=prev href=https://wangshub.github.io/posts/mlpgaussianpolicy/><link rel=next href=https://wangshub.github.io/posts/%E7%94%A8python%E8%8E%B7%E5%8F%96b%E7%AB%99%E6%92%AD%E6%94%BE%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/><link rel=canonical href=https://wangshub.github.io/posts/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E7%AE%97%E6%B3%95/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³• | ğŸ‰ ç¥å¥‡çš„æˆ˜å£«</title><meta name=title content="å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³• | ğŸ‰ ç¥å¥‡çš„æˆ˜å£«"><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/wangshub.github.io"},"articleSection":"posts","name":"å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³•","headline":"å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³•","description":"å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³• ç­–ç•¥æ¢¯åº¦çš„å…¬å¼æ¨å¯¼ â€‹ å­¦ä¹ å‚æ•°åŒ–è¡¨ç¤ºçš„ç­–ç•¥ (Parameterized policy), è¾“å…¥ç¯å¢ƒçŠ¶æ€ $ S $ æ¥é€‰æ‹©åŠ¨ä½œ $a$ ï¼Œè¿™é‡Œä½¿ç”¨ $\\theta \\in \\mathbb { R } ^ { d }$ æ¥è¡¨ç¤ºç­–ç•¥çš„å‚","inLanguage":"zh-cn","author":"ç¥å¥‡çš„æˆ˜å£«","creator":"ç¥å¥‡çš„æˆ˜å£«","publisher":"ç¥å¥‡çš„æˆ˜å£«","accountablePerson":"ç¥å¥‡çš„æˆ˜å£«","copyrightHolder":"ç¥å¥‡çš„æˆ˜å£«","copyrightYear":"2019","datePublished":"2019-01-15 19:46:17 \u002b0000 UTC","dateModified":"2019-01-15 19:46:17 \u002b0000 UTC","url":"https:\/\/wangshub.github.io\/posts\/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E7%AE%97%E6%B3%95\/","wordCount":"1877","keywords":["Algorithm","Python","ğŸ‰ ç¥å¥‡çš„æˆ˜å£«"]}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-back2home-logo"><span class=logo_mark>>$</span>
<a href=https://wangshub.github.io><span class=logo_text>cd /home/</span>
<span class=logo_cursor></span></a></div><div class=navbar-right><span class=menu><a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/categories/>Categories</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a>
<span class=divide></span><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://wangshub.github.io>ğŸ‰ ç¥å¥‡çš„æˆ˜å£«</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=/posts/><h3>Blog</h3><div class=menu-active></div></a><a class=menu-item href=/categories/><h3>Categories</h3><div class=menu-active></div></a><a class=menu-item href=/tags/><h3>Tags</h3><div class=menu-active></div></a><a class=menu-item href=/about/><h3>About</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³•</h1><div class=post-meta>Written by <a itemprop=name href=https://wangshub.github.io rel=author>ç¥å¥‡çš„æˆ˜å£«</a> with â™¥
<span class=post-time>on <time datetime=2019-01-15 itemprop=datePublished>January 15, 2019</time></span>
in
<span class=post-word-count>1877 words</span></div></header><div class=post-content><h1 id=å¼ºåŒ–å­¦ä¹ ç­–ç•¥æ¢¯åº¦ç®—æ³•>å¼ºåŒ–å­¦ä¹ :ç­–ç•¥æ¢¯åº¦ç®—æ³•</h1><h2 id=ç­–ç•¥æ¢¯åº¦çš„å…¬å¼æ¨å¯¼>ç­–ç•¥æ¢¯åº¦çš„å…¬å¼æ¨å¯¼</h2><p><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190115200214.png alt></p><p>â€‹ å­¦ä¹ <strong>å‚æ•°åŒ–è¡¨ç¤ºçš„ç­–ç•¥</strong> (Parameterized policy), è¾“å…¥ç¯å¢ƒçŠ¶æ€ $ S $ æ¥é€‰æ‹©åŠ¨ä½œ $a$ ï¼Œè¿™é‡Œä½¿ç”¨ $\theta \in \mathbb { R } ^ { d }$ æ¥è¡¨ç¤ºç­–ç•¥çš„å‚æ•°å‘é‡ï¼Œå› æ­¤ç­–ç•¥å‡½æ•°è¡¨ç¤ºä¸º</p><p>$$\pi ( a | s , \boldsymbol { \theta } ) = \operatorname { P_r } \left{ A _ { t } = a | S _ { t } = s , \boldsymbol { \theta } _ { t } = \boldsymbol { \theta } \right} \tag{1} $$</p><p>å…¶ä¸­æ—¶åˆ» $t$ ï¼Œç¯å¢ƒçŠ¶æ€ä¸º $s$ ï¼Œå‚æ•°ä¸º $\theta$ ï¼Œè¾“å‡ºåŠ¨ä½œ $a$ çš„æ¦‚ç‡ä¸º $P_r$</p><p>å› æ­¤ç”Ÿæˆé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„ä¸€ä¸ª<em>è½¨è¿¹</em>ï¼ˆtrajectoryï¼‰$\tau = (\mathbf { s } _ { 1 } , \mathbf { a } _ { 1 } , \dots , \mathbf { s } _ { T } , \mathbf { a } _ { T })$ çš„æ¦‚ç‡ä¸º</p><p>$$\underbrace { p _ { \theta } \left( \mathbf { s } _ { 1 } , \mathbf { a } _ { 1 } , \ldots , \mathbf { s } _ { T } , \mathbf { a } _ { T } \right) } _ { \pi _ { \theta } ( \tau ) } = p \left( \mathbf { s } _ { 1 } \right) \prod _ { t = 1 } ^ { T } \pi _ { \theta } \left( \mathbf { a } _ { t } | \mathbf { s } _ { t } \right) p \left( \mathbf { s } _ { t + 1 } | \mathbf { s } _ { t } , \mathbf { a } _ { t } \right) \tag{2} $$</p><p>æ›´ä¸€èˆ¬åœ°ï¼Œå°†ç­–ç•¥ $\pi$ ä¸‹ç”Ÿæˆè½¨è¿¹ $\tau$ çš„æ¦‚ç‡è¡¨ç¤ºä¸º</p><p>$$P ( \tau | \pi ) = \rho _ { 1 } \left( s _ { 1 } \right) \prod _ { t = 0 } ^ { T } P \left( s _ { t + 1 } | s _ { t } , a _ { t } \right) \pi \left( a _ { t } | s _ { t } \right) \tag{3}$$</p><p>â€‹ ç­–ç•¥æ¢¯åº¦æ–¹æ³•çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°ä¸€ç»„æœ€ä½³çš„å‚æ•° $\theta ^ { \star }$ æ¥è¡¨ç¤ºç­–ç•¥å‡½æ•°ä½¿å¾—ç´¯è®¡å¥–åŠ±çš„æœŸæœ›æœ€å¤§ï¼Œå³</p><p>$$\theta ^ { \star } = \arg \max _ { \theta } E _ { \tau \sim p _ { \theta } ( \tau ) } \left[ \sum _ { t } r \left( \mathbf { s } _ { t } , \mathbf { a } _ { t } \right) \right] \tag{4}$$</p><p>â€‹ ä»¤ç´¯ç§¯å¥–åŠ±ä¸º $R ( \tau ) = \sum _ { t = 1 } ^ { T } r \left( s _ { t } , a _ { t } \right)$ ï¼Œè®¾å®šä¼˜åŒ–ç›®æ ‡ $J\left( \pi _ { \theta } \right)$ ä¼˜åŒ–ç­–ç•¥å‚æ•°ä½¿å¾—å¥–åŠ±çš„æœŸæœ›å€¼æœ€å¤§</p><p>$$J\left( \pi _ { \theta } \right) = \underset { \tau \sim \pi _ { \theta } } { \mathrm { E } } [ R ( \tau ) ]\tag{5} $$</p><p>å¯¹ $J\left( \pi _ { \theta } \right)$ æ±‚æ¢¯åº¦å¯å¾—ç­–ç•¥æ¢¯åº¦ $\nabla _ { \theta } J ( \theta ) $ ï¼Œå…¬å¼ (6) çš„æ¨å¯¼è¿‡ç¨‹è¯·å‚è§<a href=https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html#deriving-the-simplest-policy-gradient>é“¾æ¥</a></p><p>$$\begin{aligned} \nabla _ { \theta } J ( \theta ) &= \int \nabla _ { \theta } \pi _ { \theta } ( \tau ) r ( \tau ) d \tau \&= \int \pi _ { \theta } ( \tau ) \nabla _ { \theta } \log \pi _ { \theta } ( \tau ) r ( \tau ) d \tau \ &= E _ { \tau \sim \pi _ { \theta } ( \tau ) } \left[ \nabla _ { \theta } \log \pi _ { \theta } ( \tau ) r ( \tau ) \right]\end{aligned} \tag{6}$$</p><p>å°†ç­–ç•¥ (1) ä¸¤è¾¹å– log å¯¹æ•°ï¼Œç„¶åå¸¦å…¥æ¢¯åº¦è¡¨è¾¾å¼ (6) ï¼Œæ¨å¯¼ç­–ç•¥æ¢¯åº¦çš„å…¬å¼è¯·å‚è€ƒä¸‹å›¾</p><p><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190117080942.png alt></p><p>æ ¹æ®ç­–ç•¥ $\pi _ { \theta }$ ç”Ÿæˆ $N$ æ¡è½¨è¿¹å¦‚å›¾æ‰€ç¤º</p><p><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190117084618.png alt></p><p>åˆ©ç”¨ä¸Šå›¾ $N$ æ¡è½¨è¿¹çš„ç»éªŒå¹³å‡å¯¹ç­–ç•¥æ¢¯åº¦è¿›è¡Œé€¼è¿‘ï¼Œæœ‰å…¬å¼ (7) (8)</p><p>$$J ( \theta ) = E _ { \tau \sim p _ { \theta } ( \tau ) } \left[ \sum _ { t } r \left( \mathbf { s } _ { t } , \mathbf { a } _ { t } \right) \right] \approx \frac { 1 } { N } \sum _ { i } \sum _ { t } r \left( \mathbf { s } _ { i , t } , \mathbf { a } _ { i , t } \right) \tag{7}$$</p><p>$$\nabla _ { \theta } J ( \theta ) \approx \frac { 1 } { N } \sum _ { i = 1 } ^ { N } \left( \sum _ { t = 1 } ^ { T } \nabla _ { \theta } \log \pi _ { \theta } \left( \mathbf { a } _ { i , t } | \mathbf { s } _ { i , t } \right) \right) \left( \sum _ { t = 1 } ^ { T } r \left( \mathbf { s } _ { i , t } , \mathbf { a } _ { i , t } \right) \right) \tag{8}$$</p><p>å…¶ä¸­ $N$ ä¸ºè½¨è¿¹çš„æ•°é‡ï¼Œ$T$ ä¸ºä¸€æ¡è½¨è¿¹çš„é•¿åº¦ï¼Œå‡è®¾å·²çŸ¥ç­–ç•¥ $\pi _ { \theta }$ ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¡ç®—å‡ºç­–ç•¥çš„æ¢¯åº¦ $\nabla _ { \theta } \log \pi _ { \theta } ( a | s )$ã€‚å¦ä¸€æ–¹é¢ï¼Œæ ¹æ®ç­–ç•¥ $\pi _ { \theta }$ ï¼Œåœ¨ä»¿çœŸç¯å¢ƒ $E$ ä¸­ç”Ÿæˆ $N$ æ¡è½¨è¿¹çš„æ•°æ®ï¼Œå³å¯è®¡ç®—å‡º (8)ï¼Œæ ¹æ®æ¢¯åº¦ä¸Šå‡ å¯¹å‚æ•° $\theta$ è¿›è¡Œä¸€æ­¥æ›´æ–°ï¼Œå¦‚å…¬å¼ (9)</p><p>$$
\theta \leftarrow \theta + \alpha \nabla _ { \theta } J ( \theta ) \tag{9}
$$</p><p>æ€»ç»“ä¸‹æ¥å°±æ˜¯ï¼š</p><ul><li>å¢åŠ å¸¦æ¥æ­£æ¿€åŠ±çš„æ¦‚ç‡</li><li>å‡å°‘å¸¦æ¥è´Ÿæ¿€åŠ±çš„æ¦‚ç‡</li></ul><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190117203920.png width=60%/><h2 id=ç­–ç•¥æ¢¯åº¦è’™ç‰¹å¡ç½—-reinforce-ç®—æ³•>ç­–ç•¥æ¢¯åº¦è’™ç‰¹å¡ç½— REINFORCE ç®—æ³•</h2><p>æ ¹æ®å…¬å¼ (7) (8) (9) å¯å¾—<strong>è’™ç‰¹å¡ç½— REINFORCE ç®—æ³•</strong>æµç¨‹</p><p><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190117091205.png alt=å…¬å¼ loading=lazy></p><p>å†™æˆä¼ªä»£ç å½¢å¼</p><p><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190117091717.png alt=ä¼ªä»£ç  loading=lazy></p><h2 id=example-é«˜æ–¯ç­–ç•¥æ¢¯åº¦ç®—æ³•>Example: é«˜æ–¯ç­–ç•¥æ¢¯åº¦ç®—æ³•</h2><p>ç­–ç•¥å±äºæ¦‚ç‡åˆ†å¸ƒï¼Œå¯ä»¥ç”¨ç¥ç»ç½‘ç»œæ¥è¡¨ç¤ºè¿™ç§æ¦‚ç‡åˆ†å¸ƒï¼Œè¾“å…¥çŠ¶æ€ $s$ ï¼Œç¥ç»ç½‘ç»œå°† $s$ æ˜ å°„æˆå‘é‡ $Î¼$ï¼Œç„¶åç½‘ç»œè¾“å‡ºæ¦‚ç‡ $p ( a | \mu )$ å’ŒåŠ¨ä½œé‡‡æ ·å€¼ $a \sim p ( a | \mu )$ï¼Œä»¤ $r$ ä¸º log æ ‡å‡†å·®ã€‚</p><p>$$
\mathcal { N } \left( \text { mean } = \text { NeuralNet } \left( s ; \left{ W _ { i } , b _ { i } \right} _ { i = 1 } ^ { L } \right) , stdev = exp(r) \right)
$$</p><p>å…¶ä¸­ $\mu = [ \text { mean, stdev } ]$</p><img src=https://raw.githubusercontent.com/tuibot/ImgBed/master/img/20190117204712.png><p>åœ¨è¿ç»­çš„è¿åŠ¨ç©ºé—´ä¸­ï¼Œé€šå¸¸ä½¿ç”¨<strong>é«˜æ–¯ç­–ç•¥</strong>ï¼Œå‡è®¾æ–¹å·®ä¸º $\sigma ^ { 2 }$ ï¼Œç­–ç•¥æ˜¯é«˜æ–¯çš„ï¼Œè¾“å…¥çŠ¶æ€ $s$ è¾“å‡ºåŠ¨ä½œ $a$ æœä» $a \sim \mathcal { N } \left( \mu ( s ) , \sigma ^ { 2 } \right)$ï¼Œé‚£ä¹ˆ log ç­–ç•¥æ¢¯åº¦ä¸º</p><p>$$
\nabla _ { \theta } \log \pi _ { \theta } ( s , a ) = \frac { ( a - \mu ( s ) ) \phi ( s ) } { \sigma ^ { 2 } }
\tag{10}$$</p><p>åœ¨å®é™…ä½¿ç”¨é«˜æ–¯ç­–ç•¥æ—¶ï¼Œç”¨ç¥ç»ç½‘ç»œæ¥è¡¨ç¤ºï¼Œå³ä»¤ $f _ { neural\ network } \left( \mathbf { s } _ { t } \right) = \mu ( s _ t )$ï¼Œé‚£ä¹ˆç­–ç•¥ $\pi _ \theta$</p><p>$$\log \pi _ { \theta } \left( \mathbf { a } _ { t } | \mathbf { s } _ { t } \right) = - \frac { 1 } { 2 } \left| f \left( \mathbf { s } _ { t } \right) - \mathbf { a } _ { t } \right| _ { \Sigma } ^ { 2 } + const \tag{11}$$</p><p>ç­–ç•¥çš„æ¢¯åº¦</p><p>$$\nabla _ { \theta } \log \pi _ { \theta } \left( \mathbf { a } _ { t } | \mathbf { s } _ { t } \right) = - \frac { 1 } { 2 } \Sigma ^ { - 1 } \left( f \left( \mathbf { s } _ { t } \right) - \mathbf { a } _ { t } \right) \frac { d f } { d \theta } \tag{12}$$</p><p>ç„¶ååå‘ä¼ æ’­ï¼Œæ›´æ–°ç½‘ç»œå‚æ•°</p><p>$$- \frac { 1 } { 2 } \Sigma ^ { - 1 } \left( f \left( \mathbf { s } _ { t } \right) - \mathbf { a } _ { t } \right) \left( \sum _ { t } r \left( \mathbf { s } _ { t } , \mathbf { a } _ { t } \right) \right) \tag{13}$$</p><h2 id=å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥</h2><ul><li><a href=https://hadovanhasselt.files.wordpress.com/2016/01/pg1.pdf>Lecture 8: Policy Gradient</a></li><li><a href=https://lilianweng.github.io/lil-log/2018/04/08/policy-gradient-algorithms.html>Policy Gradient Algorithms</a></li><li><a href=http://incompleteideas.net/book/the-book-2nd.html>Reinforcement Learning: An Introduction</a></li></ul></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>ç¥å¥‡çš„æˆ˜å£«</span></p><p class=copyright-item><span>Link:</span>
<a href=https://wangshub.github.io/posts/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E7%AE%97%E6%B3%95/>https://wangshub.github.io/posts/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E7%AE%97%E6%B3%95/</span></p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://wangshub.github.io/tags/algorithm/>#Algorithm</a></span>
<span class=tag><a href=https://wangshub.github.io/tags/python/>#Python</a></span></section><section><a href=javascript:window.history.back();>back</a></span> Â·
<span><a href=https://wangshub.github.io>home</a></span></section></div><div class=post-nav><a href=https://wangshub.github.io/posts/mlpgaussianpolicy/ class=prev rel=prev title=MLPGaussianPolicy><i class="iconfont icon-left"></i>&nbsp;MLPGaussianPolicy</a>
<a href=https://wangshub.github.io/posts/%E7%94%A8python%E8%8E%B7%E5%8F%96b%E7%AB%99%E6%92%AD%E6%94%BE%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/ class=next rel=next title=ç”¨Pythonè·å–Bç«™æ’­æ”¾å†å²è®°å½•>ç”¨Pythonè·å–Bç«™æ’­æ”¾å†å²è®°å½•&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2016 - 2020</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://wangshub.github.io>ç¥å¥‡çš„æˆ˜å£«</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/Mogeko/Mogege target=_blank rel="external nofollow">Mogege</a></span></div></footer><script defer src=/js/vendor_main.min.js></script><script src=https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin=anonymous></script><script>pangu.spacingPage();</script><script>MathJax={tex:{inlineMath:[["$","$"]],},displayMath:[["$$","$$"],["\[\[","\]\]"],],svg:{fontCache:"global",},};</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></div></body></html>